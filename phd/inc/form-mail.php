<?php// START CONFIG ///////////////////////////////////////////////////////////////////////// put your email address heredefine('YOUR_EMAIL_ADDRESS', 'enter.your@emailaddress.com'); $mailchimpSupport 	= false; // set 'true' to activate mailchimp supportdefine('MAILCHIMP_API_KEY', 'enter-your-mailchimp-api-key');define('MAILCHIMP_LIST_ID', 'enter-your-mailchimp-list-id');// END CONFIG /////////////////////////////////////////////////////////////////////////$formData = $_POST;$formFields = escapeAndGetFormFields($formData);$response = array();if('contact' == $formFields['form-type']['value']){	validateNoEmpty($formFields['first_name']);	validateNoEmpty($formFields['last_name']);	validateEmail($formFields['email']);	validateNoEmpty($formFields['address']);	validateNoEmpty($formFields['zip_code']);	validateNoEmpty($formFields['city']);	validateNoEmpty($formFields['plan']);	if(checkResponse($response)){		sendContact($formFields);	}	echo json_encode($response);}if('newsletter' == $formFields['form-type']['value']){		validateEmail($formFields['email']);	if(checkResponse($response)){		sendNewsletter($formFields);	}	if(checkResponse($response) && $mailchimpSupport){		sendMailchimp($formFields);	}	echo json_encode($response);}function validateNoEmpty($field){	$value = trim($field['value']);	if (empty($value)) {	    setResponse('error', $field, 'Is required');	}}function validateEmail($field){	if(!$field['value']){ 	    setResponse('error', $field, 'No email address provided');	}elseif(!preg_match("/([\w\-]+\@[\w\-]+\.[\w\-]+)/", $field['value'])) {	    setResponse('error', $field, 'Email address is invalid');	}}function escapeAndGetFormFields($formData){	$formFields = array();	foreach ($formData as $name => $value) {		$formFields[$name] = array('name' => $name, 'value' => htmlspecialchars($value));	}	return $formFields;}function setResponse($status, $field, $msg){	if(!is_null($field)){		$field = $field['name'];	}else{		$field = null;	}	$result = array('status' => $status, 'field' => $field, 'msg' => $msg);	$GLOBALS['response'][] = $result;}function checkResponse($response){	foreach ($response as $key => $value) {		if('error' == $value['status']){			return false;		}	}	return true;}function sendNewsletter($formFields){	$body  = "You have got new subscribe request from your website : <br><br>";	$body .= "Email: ".$formFields['email']['value'];	$headers  = "From: ".$formFields['email']['value']. "\r\n";	$headers .= 'Content-type: text/html; charset=utf-8' . "\r\n";	$subject = "New Subscribe";	mail(YOUR_EMAIL_ADDRESS, $subject, $body, $headers);	setResponse('success', null, 'Success! Thanks for sign up.');		}function sendContact($formFields){	$body  = 	"You have got a new registration from your website : <br><br>";	$body .=	"First Name:  ".$formFields['first_name']['value']." <br><br>";	$body .=	"Last Name:  ".$formFields['last_name']['value']." <br><br>";	$body .=	"Email:  ".$formFields['email']['value']." <br><br>";	$body .=	"Address:  ".$formFields['address']['value']." <br><br>";	$body .=	"Zip Code:  ".$formFields['zip_code']['value']." <br><br>";	$body .=	"City:  ".$formFields['city']['value']." <br><br>";	$body .=	"Plan:  ".$formFields['plan']['value']." <br><br>";		$headers  = "From: ".$formFields['email']['value']. "\r\n";	$headers .= 'Content-type: text/html; charset=utf-8' . "\r\n";	$subject = "New Registration";		mail(YOUR_EMAIL_ADDRESS, $subject, $body, $headers );	setResponse('success', null, 'Success! Your registration has been send.');}function sendMailchimp($formFields){	require_once('MCAPI.class.php');	$api = new MCAPI(MAILCHIMP_API_KEY);		if($api->listSubscribe(MAILCHIMP_LIST_ID, $formFields['email']['value'], '') === true) {		setResponse('success', null, 'Success! Check your email to confirm sign up.');	}else{			setResponse('error', $formFields['email'], 'Error: ' . $api->errorMessage);	}	}?>